<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blais Beats - Firebase Admin Dashboard</title>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-storage-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            color: #ffffff;
            min-height: 100vh;
        }

        .admin-container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar Navigation */
        .sidebar {
            width: 280px;
            background: rgba(20, 20, 30, 0.95);
            border-right: 2px solid rgba(0, 255, 255, 0.3);
            backdrop-filter: blur(10px);
            overflow-y: auto;
            position: fixed;
            height: 100vh;
            z-index: 1000;
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid rgba(0, 255, 255, 0.2);
            text-align: center;
        }

        .sidebar-header h1 {
            color: #00FFFF;
            font-size: 24px;
            font-weight: bold;
        }

        .sidebar-header p {
            color: #888;
            font-size: 14px;
            margin-top: 5px;
        }

        .nav-section {
            margin: 20px 0;
        }

        .nav-section h3 {
            color: #00FFFF;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
            padding: 0 20px 10px 20px;
            border-bottom: 1px solid rgba(0, 255, 255, 0.1);
            margin-bottom: 10px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            color: #ccc;
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
            border-left: 3px solid transparent;
        }

        .nav-item:hover {
            background: rgba(0, 255, 255, 0.1);
            color: #00FFFF;
            border-left-color: #00FFFF;
        }

        .nav-item.active {
            background: rgba(0, 255, 255, 0.2);
            color: #00FFFF;
            border-left-color: #00FFFF;
        }

        .nav-item i {
            width: 20px;
            margin-right: 12px;
            text-align: center;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 280px;
            padding: 20px;
            overflow-y: auto;
        }

        .dashboard-header {
            background: rgba(20, 20, 30, 0.8);
            padding: 25px;
            border-radius: 15px;
            border: 1px solid rgba(0, 255, 255, 0.3);
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
        }

        .dashboard-title {
            font-size: 32px;
            color: #00FFFF;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .dashboard-subtitle {
            color: #888;
            font-size: 16px;
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(20, 20, 30, 0.8);
            padding: 25px;
            border-radius: 15px;
            border: 1px solid rgba(0, 255, 255, 0.3);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            border-color: #00FFFF;
            box-shadow: 0 10px 30px rgba(0, 255, 255, 0.2);
        }

        .stat-number {
            font-size: 36px;
            font-weight: bold;
            color: #00FFFF;
            margin-bottom: 10px;
        }

        .stat-label {
            color: #ccc;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Content Sections */
        .content-section {
            background: rgba(20, 20, 30, 0.8);
            border-radius: 15px;
            border: 1px solid rgba(0, 255, 255, 0.3);
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
            display: none;
        }

        .content-section.active {
            display: block;
        }

        .section-header {
            padding: 25px;
            border-bottom: 1px solid rgba(0, 255, 255, 0.2);
        }

        .section-title {
            font-size: 24px;
            color: #00FFFF;
            margin-bottom: 10px;
        }

        .section-description {
            color: #888;
            font-size: 14px;
        }

        .section-content {
            padding: 25px;
        }

        /* Upload Areas */
        .upload-area {
            border: 2px dashed rgba(0, 255, 255, 0.5);
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            margin: 20px 0;
            transition: all 0.3s ease;
            cursor: pointer;
            background: rgba(0, 255, 255, 0.05);
        }

        .upload-area:hover, .upload-area.dragover {
            border-color: #00FFFF;
            background: rgba(0, 255, 255, 0.1);
            transform: scale(1.02);
        }

        .upload-icon {
            font-size: 48px;
            color: #00FFFF;
            margin-bottom: 20px;
        }

        .upload-text {
            font-size: 18px;
            color: #ccc;
            margin-bottom: 10px;
        }

        .upload-subtext {
            font-size: 14px;
            color: #888;
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            color: #00FFFF;
            font-weight: bold;
            margin-bottom: 8px;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .form-control {
            width: 100%;
            padding: 15px;
            background: rgba(10, 10, 20, 0.8);
            border: 1px solid rgba(0, 255, 255, 0.3);
            border-radius: 8px;
            color: #fff;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: #00FFFF;
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.3);
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        /* Buttons */
        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }

        .btn-primary {
            background: linear-gradient(45deg, #00FFFF, #0080FF);
            color: #000;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 255, 255, 0.4);
        }

        .btn-success {
            background: linear-gradient(45deg, #00FF80, #00CC60);
            color: #000;
        }

        .btn-danger {
            background: linear-gradient(45deg, #FF4444, #CC0000);
            color: #fff;
        }

        .btn-secondary {
            background: rgba(100, 100, 100, 0.5);
            color: #fff;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        /* Progress Bar */
        .progress-container {
            margin: 20px 0;
            display: none;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(0, 255, 255, 0.2);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00FFFF, #0080FF);
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 4px;
        }

        .progress-text {
            text-align: center;
            margin-top: 10px;
            color: #00FFFF;
            font-weight: bold;
        }

        /* Status Messages */
        .status-message {
            padding: 15px 20px;
            border-radius: 8px;
            margin: 20px 0;
            font-weight: bold;
            border-left: 4px solid;
        }

        .status-success {
            background: rgba(0, 255, 128, 0.1);
            color: #00FF80;
            border-left-color: #00FF80;
        }

        .status-error {
            background: rgba(255, 68, 68, 0.1);
            color: #FF4444;
            border-left-color: #FF4444;
        }

        .status-info {
            background: rgba(0, 255, 255, 0.1);
            color: #00FFFF;
            border-left-color: #00FFFF;
        }

        .status-warning {
            background: rgba(255, 193, 7, 0.1);
            color: #FFC107;
            border-left-color: #FFC107;
        }

        /* File List */
        .file-list {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid rgba(0, 255, 255, 0.3);
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.3);
        }

        .file-item {
            display: flex;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid rgba(0, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .file-item:hover {
            background: rgba(0, 255, 255, 0.05);
        }

        .file-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 18px;
        }

        .file-info {
            flex: 1;
        }

        .file-name {
            font-weight: bold;
            color: #fff;
            margin-bottom: 5px;
        }

        .file-details {
            font-size: 12px;
            color: #888;
        }

        .file-actions {
            display: flex;
            gap: 10px;
        }

        /* Beat Grid */
        .beats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .beat-card {
            background: rgba(10, 10, 20, 0.8);
            border: 1px solid rgba(0, 255, 255, 0.3);
            border-radius: 15px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .beat-card:hover {
            transform: translateY(-5px);
            border-color: #00FFFF;
            box-shadow: 0 10px 30px rgba(0, 255, 255, 0.2);
        }

        .beat-title {
            font-size: 18px;
            font-weight: bold;
            color: #00FFFF;
            margin-bottom: 10px;
        }

        .beat-details {
            color: #ccc;
            font-size: 14px;
            margin-bottom: 15px;
        }

        .beat-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }

            .sidebar.mobile-open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }
        }

        .hidden {
            display: none !important;
        }

        /* Loading Animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(0, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #00FFFF;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Bulk Operations */
        .bulk-operations {
            background: rgba(0, 255, 255, 0.1);
            border: 1px solid rgba(0, 255, 255, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .bulk-title {
            color: #00FFFF;
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .bulk-actions {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <!-- Sidebar Navigation -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1>🎵 BLAIS ADMIN</h1>
                <p>Firebase Dashboard</p>
            </div>

            <div class="nav-section">
                <h3>📊 Overview</h3>
                <div class="nav-item active" data-section="dashboard">
                    <i>📈</i> Dashboard
                </div>
                <div class="nav-item" data-section="analytics">
                    <i>📊</i> Analytics
                </div>
            </div>

            <div class="nav-section">
                <h3>🎵 Beat Management</h3>
                <div class="nav-item" data-section="upload">
                    <i>📤</i> Upload Beats
                </div>
                <div class="nav-item" data-section="bulk-upload">
                    <i>📦</i> Bulk Upload
                </div>
                <div class="nav-item" data-section="catalog">
                    <i>🎼</i> Beat Catalog
                </div>
                <div class="nav-item" data-section="organize">
                    <i>🗂️</i> Organize Files
                </div>
            </div>

            <div class="nav-section">
                <h3>💼 Business</h3>
                <div class="nav-item" data-section="orders">
                    <i>🛒</i> Orders
                </div>
                <div class="nav-item" data-section="customers">
                    <i>👥</i> Customers
                </div>
                <div class="nav-item" data-section="revenue">
                    <i>💰</i> Revenue
                </div>
            </div>

            <div class="nav-section">
                <h3>⚙️ System</h3>
                <div class="nav-item" data-section="settings">
                    <i>⚙️</i> Settings
                </div>
                <div class="nav-item" data-section="storage">
                    <i>💾</i> Storage
                </div>
                <div class="nav-item" data-section="backup">
                    <i>🔄</i> Backup
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard Header -->
            <div class="dashboard-header">
                <h1 class="dashboard-title">Firebase Admin Dashboard</h1>
                <p class="dashboard-subtitle">Manage your beat store with Firebase backend</p>
            </div>

            <!-- Dashboard Section -->
            <div id="dashboard" class="content-section active">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="total-beats">-</div>
                        <div class="stat-label">Total Beats</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="total-orders">-</div>
                        <div class="stat-label">Total Orders</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="total-revenue">$-</div>
                        <div class="stat-label">Total Revenue</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="storage-used">-</div>
                        <div class="stat-label">Storage Used</div>
                    </div>
                </div>

                <div class="content-section active">
                    <div class="section-header">
                        <h2 class="section-title">🚀 Quick Actions</h2>
                        <p class="section-description">Common administrative tasks</p>
                    </div>
                    <div class="section-content">
                        <div class="bulk-actions">
                            <button class="btn btn-primary" onclick="refreshStats()">
                                🔄 Refresh Stats
                            </button>
                            <button class="btn btn-success" onclick="switchSection('upload')">
                                📤 Upload Beat
                            </button>
                            <button class="btn btn-secondary" onclick="switchSection('catalog')">
                                🎼 View Catalog
                            </button>
                            <button class="btn btn-secondary" onclick="exportCatalog()">
                                💾 Export Data
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Upload Section -->
            <div id="upload" class="content-section">
                <div class="section-header">
                    <h2 class="section-title">📤 Upload New Beat</h2>
                    <p class="section-description">Add a single beat to your catalog</p>
                </div>
                <div class="section-content">
                    <form id="upload-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Beat Title</label>
                                <input type="text" class="form-control" id="beat-title" required>
                            </div>
                            <div class="form-group">
                                <label>Artist</label>
                                <input type="text" class="form-control" id="beat-artist" value="BLAIS">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label>BPM</label>
                                <input type="number" class="form-control" id="beat-bpm" min="60" max="200">
                            </div>
                            <div class="form-group">
                                <label>Key</label>
                                <select class="form-control" id="beat-key">
                                    <option value="">Select Key</option>
                                    <option value="C Major">C Major</option>
                                    <option value="C Minor">C Minor</option>
                                    <option value="G Major">G Major</option>
                                    <option value="G Minor">G Minor</option>
                                    <option value="D Major">D Major</option>
                                    <option value="D Minor">D Minor</option>
                                    <option value="A Major">A Major</option>
                                    <option value="A Minor">A Minor</option>
                                    <option value="E Major">E Major</option>
                                    <option value="E Minor">E Minor</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Genre</label>
                                <select class="form-control" id="beat-genre">
                                    <option value="Hip Hop">Hip Hop</option>
                                    <option value="Trap">Trap</option>
                                    <option value="R&B">R&B</option>
                                    <option value="Boom Bap">Boom Bap</option>
                                    <option value="Drill">Drill</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Price ($)</label>
                                <input type="number" class="form-control" id="beat-price" step="0.01" value="39.99">
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Description</label>
                            <textarea class="form-control" id="beat-description" rows="3"></textarea>
                        </div>

                        <!-- File Upload Areas -->
                        <div class="form-row">
                            <div class="form-group">
                                <label>WAV File</label>
                                <div class="upload-area" data-type="wav">
                                    <div class="upload-icon">🎵</div>
                                    <div class="upload-text">Drop WAV file here</div>
                                    <div class="upload-subtext">or click to browse</div>
                                    <input type="file" accept=".wav" style="display: none;">
                                </div>
                            </div>
                            <div class="form-group">
                                <label>MP3 Preview</label>
                                <div class="upload-area" data-type="mp3">
                                    <div class="upload-icon">🎧</div>
                                    <div class="upload-text">Drop MP3 file here</div>
                                    <div class="upload-subtext">or click to browse</div>
                                    <input type="file" accept=".mp3" style="display: none;">
                                </div>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label>Stems (ZIP)</label>
                                <div class="upload-area" data-type="stems">
                                    <div class="upload-icon">📦</div>
                                    <div class="upload-text">Drop ZIP file here</div>
                                    <div class="upload-subtext">or click to browse</div>
                                    <input type="file" accept=".zip" style="display: none;">
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Artwork</label>
                                <div class="upload-area" data-type="artwork">
                                    <div class="upload-icon">🖼️</div>
                                    <div class="upload-text">Drop image here</div>
                                    <div class="upload-subtext">or click to browse</div>
                                    <input type="file" accept="image/*" style="display: none;">
                                </div>
                            </div>
                        </div>

                        <div class="progress-container" id="upload-progress">
                            <div class="progress-bar">
                                <div class="progress-fill"></div>
                            </div>
                            <div class="progress-text">Uploading...</div>
                        </div>

                        <div class="form-group">
                            <button type="submit" class="btn btn-primary">
                                🚀 Upload Beat
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="clearForm()">
                                🗑️ Clear Form
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Bulk Upload Section -->
            <div id="bulk-upload" class="content-section">
                <div class="section-header">
                    <h2 class="section-title">📦 Bulk Upload</h2>
                    <p class="section-description">Upload multiple beats at once</p>
                </div>
                <div class="section-content">
                    <div class="bulk-operations">
                        <div class="bulk-title">Upload Multiple Files</div>
                        <div class="upload-area" id="bulk-upload-area">
                            <div class="upload-icon">📦</div>
                            <div class="upload-text">Drop multiple files here</div>
                            <div class="upload-subtext">Supports WAV, MP3, ZIP, and images</div>
                            <input type="file" multiple accept=".wav,.mp3,.zip,image/*" style="display: none;" id="bulk-file-input">
                        </div>
                    </div>

                    <div id="bulk-file-list" class="file-list" style="display: none;">
                        <!-- Bulk files will be listed here -->
                    </div>

                    <div class="bulk-actions" id="bulk-actions" style="display: none;">
                        <button class="btn btn-primary" onclick="processBulkUpload()">
                            🚀 Process All Files
                        </button>
                        <button class="btn btn-secondary" onclick="clearBulkUpload()">
                            🗑️ Clear All
                        </button>
                    </div>
                </div>
            </div>

            <!-- Beat Catalog Section -->
            <div id="catalog" class="content-section">
                <div class="section-header">
                    <h2 class="section-title">🎼 Beat Catalog</h2>
                    <p class="section-description">Manage your existing beats</p>
                </div>
                <div class="section-content">
                    <div class="bulk-operations">
                        <div class="bulk-title">Catalog Actions</div>
                        <div class="bulk-actions">
                            <button class="btn btn-primary" onclick="loadCatalog()">
                                🔄 Refresh Catalog
                            </button>
                            <button class="btn btn-success" onclick="addSampleBeats()">
                                ➕ Add Sample Beats
                            </button>
                            <button class="btn btn-danger" onclick="clearCatalog()">
                                🗑️ Clear All Beats
                            </button>
                        </div>
                    </div>

                    <div id="beats-container" class="beats-grid">
                        <!-- Beats will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Storage Section -->
            <div id="storage" class="content-section">
                <div class="section-header">
                    <h2 class="section-title">💾 Firebase Storage</h2>
                    <p class="section-description">Manage your Firebase storage</p>
                </div>
                <div class="section-content">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number" id="storage-files">-</div>
                            <div class="stat-label">Total Files</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="storage-size">-</div>
                            <div class="stat-label">Total Size</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="storage-beats-folder">-</div>
                            <div class="stat-label">Beat Files</div>
                        </div>
                    </div>

                    <div class="bulk-operations">
                        <div class="bulk-title">Storage Actions</div>
                        <div class="bulk-actions">
                            <button class="btn btn-primary" onclick="analyzeStorage()">
                                🔍 Analyze Storage
                            </button>
                            <button class="btn btn-secondary" onclick="optimizeStorage()">
                                ⚡ Optimize Files
                            </button>
                            <button class="btn btn-danger" onclick="cleanupStorage()">
                                🧹 Cleanup Unused
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Status Messages -->
            <div id="status-container"></div>
        </main>
    </div>

    <script src="firebase-beats-manager.js"></script>
    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAfMYFvW7NbsFGPFAOiE6O2lljdaLGfhfA",
            authDomain: "prometheai-1me5o.firebaseapp.com",
            projectId: "prometheai-1me5o",
            storageBucket: "prometheai-1me5o.firebasestorage.app",
            messagingSenderId: "427862967088",
            appId: "1:427862967088:web:777de6c6b2ac5393763ef5",
            measurementId: "G-3J491JX7NP"
        };

        let firebaseBeatStore;
        let currentSection = 'dashboard';

        // Initialize Firebase
        document.addEventListener('DOMContentLoaded', function() {
            firebase.initializeApp(firebaseConfig);
            firebaseBeatStore = new FirebaseBeatStore();

            setupNavigation();
            setupFileUploads();
            setupBulkUpload();
            refreshStats();

            showStatus('Firebase Admin Dashboard loaded successfully!', 'success');
        });

        function setupNavigation() {
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => {
                item.addEventListener('click', () => {
                    const section = item.dataset.section;
                    if (section) {
                        switchSection(section);
                    }
                });
            });
        }

        function switchSection(sectionName) {
            // Update navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector(`[data-section="${sectionName}"]`)?.classList.add('active');

            // Update content
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(sectionName)?.classList.add('active');

            currentSection = sectionName;

            // Load section-specific data
            if (sectionName === 'catalog') {
                loadCatalog();
            } else if (sectionName === 'storage') {
                analyzeStorage();
            }
        }

        function setupFileUploads() {
            const uploadAreas = document.querySelectorAll('.upload-area');
            uploadAreas.forEach(area => {
                const input = area.querySelector('input[type="file"]');

                area.addEventListener('click', () => input?.click());

                area.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    area.classList.add('dragover');
                });

                area.addEventListener('dragleave', () => {
                    area.classList.remove('dragover');
                });

                area.addEventListener('drop', (e) => {
                    e.preventDefault();
                    area.classList.remove('dragover');

                    if (input && e.dataTransfer.files.length > 0) {
                        input.files = e.dataTransfer.files;
                        updateUploadPreview(area, e.dataTransfer.files[0]);
                    }
                });

                input?.addEventListener('change', (e) => {
                    if (e.target.files.length > 0) {
                        updateUploadPreview(area, e.target.files[0]);
                    }
                });
            });

            // Setup upload form
            document.getElementById('upload-form').addEventListener('submit', handleSingleUpload);
        }

        function updateUploadPreview(area, file) {
            const icon = area.querySelector('.upload-icon');
            const text = area.querySelector('.upload-text');
            const subtext = area.querySelector('.upload-subtext');

            text.textContent = file.name;
            subtext.textContent = `${(file.size / 1024 / 1024).toFixed(2)} MB`;
            area.style.borderColor = '#00FF80';
            area.style.background = 'rgba(0, 255, 128, 0.1)';
        }

        async function handleSingleUpload(e) {
            e.preventDefault();

            const form = e.target;
            const formData = new FormData(form);

            const beatData = {
                title: document.getElementById('beat-title').value,
                artist: document.getElementById('beat-artist').value,
                bpm: parseInt(document.getElementById('beat-bpm').value) || 140,
                key: document.getElementById('beat-key').value,
                genre: document.getElementById('beat-genre').value,
                price: parseFloat(document.getElementById('beat-price').value) || 39.99,
                description: document.getElementById('beat-description').value
            };

            const files = {
                wav: document.querySelector('[data-type="wav"] input').files[0],
                mp3: document.querySelector('[data-type="mp3"] input').files[0],
                stems: document.querySelector('[data-type="stems"] input').files[0],
                artwork: document.querySelector('[data-type="artwork"] input').files[0]
            };

            if (!beatData.title) {
                showStatus('Please enter a beat title', 'error');
                return;
            }

            if (!files.wav && !files.mp3) {
                showStatus('Please select at least a WAV or MP3 file', 'error');
                return;
            }

            try {
                showProgress(true);
                showStatus('Uploading beat to Firebase...', 'info');

                const result = await firebaseBeatStore.uploadBeatFiles(beatData, files);
                const addResult = await firebaseBeatStore.addBeat(beatData, result);

                if (addResult.success) {
                    showStatus(`Beat "${beatData.title}" uploaded successfully!`, 'success');
                    clearForm();
                    refreshStats();
                } else {
                    throw new Error(addResult.error);
                }
            } catch (error) {
                showStatus(`Upload failed: ${error.message}`, 'error');
            } finally {
                showProgress(false);
            }
        }

        function setupBulkUpload() {
            const bulkArea = document.getElementById('bulk-upload-area');
            const bulkInput = document.getElementById('bulk-file-input');

            bulkArea.addEventListener('click', () => bulkInput.click());

            bulkArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                bulkArea.classList.add('dragover');
            });

            bulkArea.addEventListener('dragleave', () => {
                bulkArea.classList.remove('dragover');
            });

            bulkArea.addEventListener('drop', (e) => {
                e.preventDefault();
                bulkArea.classList.remove('dragover');
                handleBulkFiles(e.dataTransfer.files);
            });

            bulkInput.addEventListener('change', (e) => {
                handleBulkFiles(e.target.files);
            });
        }

        function handleBulkFiles(files) {
            const fileList = document.getElementById('bulk-file-list');
            const bulkActions = document.getElementById('bulk-actions');

            fileList.innerHTML = '';
            fileList.style.display = 'block';
            bulkActions.style.display = 'block';

            Array.from(files).forEach((file, index) => {
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                fileItem.innerHTML = `
                    <div class="file-icon" style="background: ${getFileTypeColor(file.type)}">
                        ${getFileTypeIcon(file.type)}
                    </div>
                    <div class="file-info">
                        <div class="file-name">${file.name}</div>
                        <div class="file-details">${(file.size / 1024 / 1024).toFixed(2)} MB • ${file.type || 'Unknown'}</div>
                    </div>
                    <div class="file-actions">
                        <button class="btn btn-danger" onclick="removeBulkFile(${index})">×</button>
                    </div>
                `;
                fileList.appendChild(fileItem);
            });

            showStatus(`${files.length} files selected for bulk upload`, 'info');
        }

        function getFileTypeColor(type) {
            if (type.includes('audio')) return 'rgba(0, 255, 255, 0.2)';
            if (type.includes('image')) return 'rgba(255, 128, 0, 0.2)';
            if (type.includes('zip')) return 'rgba(128, 255, 0, 0.2)';
            return 'rgba(255, 255, 255, 0.2)';
        }

        function getFileTypeIcon(type) {
            if (type.includes('audio')) return '🎵';
            if (type.includes('image')) return '🖼️';
            if (type.includes('zip')) return '📦';
            return '📄';
        }

        async function processBulkUpload() {
            const files = document.getElementById('bulk-file-input').files;
            if (files.length === 0) return;

            showStatus('Processing bulk upload...', 'info');
            showProgress(true);

            // Group files by beat name
            const beatGroups = groupFilesByName(files);
            let processed = 0;
            let errors = 0;

            for (const [beatName, fileGroup] of Object.entries(beatGroups)) {
                try {
                    const beatData = {
                        title: beatName,
                        artist: 'BLAIS',
                        bpm: 140,
                        genre: 'Hip Hop',
                        price: 39.99,
                        description: `${beatName} - Produced by BLAIS`
                    };

                    const result = await firebaseBeatStore.uploadBeatFiles(beatData, fileGroup);
                    const addResult = await firebaseBeatStore.addBeat(beatData, result);

                    if (addResult.success) {
                        processed++;
                    } else {
                        errors++;
                    }
                } catch (error) {
                    errors++;
                    console.error(`Error processing ${beatName}:`, error);
                }
            }

            showProgress(false);
            showStatus(`Bulk upload complete: ${processed} beats uploaded, ${errors} errors`,
                errors > 0 ? 'warning' : 'success');

            if (processed > 0) {
                refreshStats();
                clearBulkUpload();
            }
        }

        function groupFilesByName(files) {
            const groups = {};

            Array.from(files).forEach(file => {
                const baseName = file.name.replace(/\.(wav|mp3|zip|jpg|png|jpeg)$/i, '');
                const cleanName = baseName.replace(/[-_](stems|instrumental|beat).*$/i, '');

                if (!groups[cleanName]) {
                    groups[cleanName] = {};
                }

                const ext = file.name.split('.').pop().toLowerCase();
                if (ext === 'wav') groups[cleanName].wav = file;
                else if (ext === 'mp3') groups[cleanName].mp3 = file;
                else if (ext === 'zip') groups[cleanName].stems = file;
                else if (['jpg', 'png', 'jpeg'].includes(ext)) groups[cleanName].artwork = file;
            });

            return groups;
        }

        function clearBulkUpload() {
            document.getElementById('bulk-file-input').value = '';
            document.getElementById('bulk-file-list').style.display = 'none';
            document.getElementById('bulk-actions').style.display = 'none';
        }

        async function refreshStats() {
            try {
                const beats = await firebaseBeatStore.loadBeats();
                document.getElementById('total-beats').textContent = beats.length;

                // Mock data for now - you can implement real analytics
                document.getElementById('total-orders').textContent = '47';
                document.getElementById('total-revenue').textContent = '$1,879';
                document.getElementById('storage-used').textContent = '2.3GB';

                showStatus('Statistics refreshed', 'success');
            } catch (error) {
                showStatus('Error loading statistics', 'error');
            }
        }

        async function loadCatalog() {
            try {
                showStatus('Loading beat catalog...', 'info');
                const beats = await firebaseBeatStore.loadBeats();

                const container = document.getElementById('beats-container');
                container.innerHTML = '';

                beats.forEach(beat => {
                    const beatCard = document.createElement('div');
                    beatCard.className = 'beat-card';
                    beatCard.innerHTML = `
                        <div class="beat-title">${beat.title}</div>
                        <div class="beat-details">
                            ${beat.bpm} BPM • ${beat.key || 'Unknown Key'} • ${beat.genre} • $${beat.price}
                        </div>
                        <div class="beat-actions">
                            <button class="btn btn-secondary" onclick="editBeat('${beat.id}')">✏️ Edit</button>
                            <button class="btn btn-danger" onclick="deleteBeat('${beat.id}')">🗑️ Delete</button>
                        </div>
                    `;
                    container.appendChild(beatCard);
                });

                showStatus(`Loaded ${beats.length} beats`, 'success');
            } catch (error) {
                showStatus('Error loading catalog', 'error');
            }
        }

        async function addSampleBeats() {
            const sampleBeats = [
                { title: 'Midnight Vibes', bpm: 140, key: 'C Minor', genre: 'Hip Hop', price: 39.99 },
                { title: 'Neon Dreams', bpm: 128, key: 'G Major', genre: 'Trap', price: 39.99 },
                { title: 'Urban Legends', bpm: 145, key: 'D Minor', genre: 'Boom Bap', price: 39.99 },
                { title: 'Digital Sunset', bpm: 120, key: 'A Minor', genre: 'R&B', price: 39.99 },
                { title: 'Bass Thunder', bpm: 155, key: 'E Minor', genre: 'Drill', price: 39.99 }
            ];

            showStatus('Adding sample beats...', 'info');
            let added = 0;

            for (const beat of sampleBeats) {
                try {
                    const result = await firebaseBeatStore.addBeat(beat, {});
                    if (result.success) added++;
                } catch (error) {
                    console.error('Error adding sample beat:', error);
                }
            }

            showStatus(`Added ${added} sample beats`, 'success');
            refreshStats();
            loadCatalog();
        }

        async function analyzeStorage() {
            showStatus('Analyzing Firebase storage...', 'info');
            // Mock storage analysis - implement real storage analysis
            document.getElementById('storage-files').textContent = '156';
            document.getElementById('storage-size').textContent = '2.3GB';
            document.getElementById('storage-beats-folder').textContent = '142';
        }

        function clearForm() {
            document.getElementById('upload-form').reset();
            document.querySelectorAll('.upload-area').forEach(area => {
                area.style.borderColor = '';
                area.style.background = '';
                area.querySelector('.upload-text').textContent = area.dataset.type === 'wav' ? 'Drop WAV file here' :
                    area.dataset.type === 'mp3' ? 'Drop MP3 file here' :
                    area.dataset.type === 'stems' ? 'Drop ZIP file here' : 'Drop image here';
                area.querySelector('.upload-subtext').textContent = 'or click to browse';
            });
        }

        function showProgress(show) {
            const progress = document.getElementById('upload-progress');
            if (show) {
                progress.style.display = 'block';
                // Animate progress bar
                const fill = progress.querySelector('.progress-fill');
                let width = 0;
                const interval = setInterval(() => {
                    width += Math.random() * 10;
                    if (width >= 90) {
                        clearInterval(interval);
                        width = 90;
                    }
                    fill.style.width = width + '%';
                }, 200);
                progress.dataset.interval = interval;
            } else {
                const fill = progress.querySelector('.progress-fill');
                fill.style.width = '100%';
                setTimeout(() => {
                    progress.style.display = 'none';
                    fill.style.width = '0%';
                    if (progress.dataset.interval) {
                        clearInterval(progress.dataset.interval);
                    }
                }, 500);
            }
        }

        function showStatus(message, type = 'info') {
            const container = document.getElementById('status-container');
            const status = document.createElement('div');
            status.className = `status-message status-${type}`;
            status.textContent = message;

            container.appendChild(status);

            setTimeout(() => {
                status.remove();
            }, 5000);
        }

        function exportCatalog() {
            showStatus('Exporting catalog data...', 'info');
            // Implement catalog export
            setTimeout(() => {
                showStatus('Catalog export ready for download', 'success');
            }, 2000);
        }

        function editBeat(beatId) {
            showStatus(`Editing beat ${beatId}`, 'info');
            // Implement beat editing
        }

        function deleteBeat(beatId) {
            if (confirm('Are you sure you want to delete this beat?')) {
                showStatus(`Deleting beat ${beatId}`, 'info');
                // Implement beat deletion
            }
        }
    </script>
</body>
</html>